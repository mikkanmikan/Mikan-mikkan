<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>英単語学習 + Weibullモデル</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
body { font-family: sans-serif; margin: 20px; }
input { margin-top: 5px; }
button { margin-top: 10px; padding: 5px 10px; }
#result { margin-top: 15px; font-weight: bold; }
#chartContainer { width: 80%; max-width: 600px; margin-top: 20px; }
</style>
</head>
<body>

<h1>英単語学習（5問） + 次回学習日計算</h1>

<div id="quiz"></div>
<div id="result"></div>
<div id="chartContainer">
  <canvas id="forgetChart"></canvas>
</div>

<script>
const const words = [
  {eng: "ephemeral", jap: "はかない"},
  {eng: "obfuscate", jap: "わかりにくくする"},
  {eng: "quintessential", jap: "典型的な"},
  {eng: "juxtaposition", jap: "並置"},
  {eng: "ubiquitous", jap: "偏在する"},
  {eng: "serendipity", jap: "偶然の幸運"},
  {eng: "cogent", jap: "説得力のある"},
  {eng: "antediluvian", jap: "太古の"},
  {eng: "magnanimous", jap: "寛大な"},
  {eng: "perfunctory", jap: "おざなりの"}
];

// シャッフルして5問取得
function getRandomWords(n) {
    let shuffled = [...words].sort(() => 0.5 - Math.random());
    return shuffled.slice(0, n);
}

let quizWords = getRandomWords(5);
let current = 0;
let correctCount = 0;

// 初期パラメータ
const alpha = 1.0;
const beta = 2.0;

function showQuestion() {
    if(current >= quizWords.length){
        showResult();
        return;
    }
    let q = quizWords[current];
    document.getElementById("quiz").innerHTML = `
        <div>問題 ${current+1}: ${q.eng}</div>
        <input type="text" id="answer" placeholder="日本語を入力">
        <button onclick="checkAnswer()">回答</button>
    `;
}

function checkAnswer() {
    let userAns = document.getElementById("answer").value.trim();
    let correctAns = quizWords[current].jap;
    let resDiv = document.getElementById("result");
    if(userAns === correctAns){
        correctCount++;
        resDiv.innerHTML = `正解！答え: ${correctAns}`;
    } else {
        resDiv.innerHTML = `不正解。答え: ${correctAns}`;
    }
    current++;
    setTimeout(() => {
        resDiv.innerHTML = "";
        showQuestion();
    }, 1000);
}

// ワイブル次回学習日計算
function calcNextDay(R) {
    return beta * Math.pow(-Math.log(R), 1/alpha);
}

// 忘却曲線描画
function drawChart(R) {
    const ctx = document.getElementById('forgetChart').getContext('2d');
    let tVals = Array.from({length: 50}, (_, i) => i*0.1);
    let Rvals = tVals.map(t => Math.exp(-(t/beta)**alpha));

    new Chart(ctx, {
        type: 'line',
        data: {
            labels: tVals,
            datasets: [{
                label: '忘却曲線',
                data: Rvals,
                borderColor:
