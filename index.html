<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ãƒ­ãƒƒã‚¯ä»˜ãã‚¬ãƒãƒ£ã‚¢ãƒ—ãƒª</title>
<style>
body {
  font-family: sans-serif;
  text-align: center;
  background: #111;
  color: white;
}

#startScreen {
  margin-top: 50px;
}

#gachaArea {
  font-size: 30px;
  margin-bottom: 40px;
}

#startBtn {
  font-size: 30px;
  padding: 20px 60px;
  cursor: pointer;
}

#resultScreen {
  position: fixed;
  top:0; left:0;
  width:100%; height:100%;
  background: rgba(0,0,0,0.8);
  display: none;
  justify-content: center;
  align-items: center;
}

#resultBox {
  background: white;
  color: black;
  width: 300px;
  height: 200px;
  position: relative;
  padding: 20px;
  border-radius: 10px;
}

#closeBtn {
  position: absolute;
  top: 5px;
  right: 10px;
  font-size: 20px;
  cursor: pointer;
}

.rainbow {
  font-size: 40px;
  font-weight: bold;
  background: linear-gradient(90deg, red, orange, yellow, green, cyan, blue, purple);
  -webkit-background-clip: text;
  color: transparent;
}

#timer, #count {
  font-size: 20px;
  margin-top: 20px;
}
</style>
</head>

<body>

<!-- ã‚¹ã‚¿ãƒ¼ãƒˆç”»é¢ -->
<div id="startScreen">
  <div id="gachaArea">ğŸ° ã‚¬ãƒãƒ£ç”»é¢</div>
  <button id="startBtn">START</button>
</div>

<!-- çµæœç”»é¢ -->
<div id="resultScreen">
  <div id="resultBox">
    <div id="closeBtn">Ã—</div>
    <div id="rankText" class="rainbow"></div>
    <p id="effectText"></p>
  </div>
</div>

<p id="timer">å¾…æ©Ÿä¸­</p>
<p id="count">å›æ•°: 0</p>

<script>
let count = 0;
let locked = false;
let timerInterval;

const startBtn = document.getElementById("startBtn");
const startScreen = document.getElementById("startScreen");
const resultScreen = document.getElementById("resultScreen");
const rankText = document.getElementById("rankText");
const effectText = document.getElementById("effectText");
const timerDisplay = document.getElementById("timer");
const countDisplay = document.getElementById("count");
const closeBtn = document.getElementById("closeBtn");

// ã‚¬ãƒãƒ£ç¢ºç‡ï¼ˆè‡ªç”±ã«èª¿æ•´å¯ï¼‰
const ranks = [
  {name:"N", time:300, prob:0.4},
  {name:"R", time:300, prob:0.3},
  {name:"SR", time:600, prob:0.2},
  {name:"UR", time:1200, prob:0.09},
  {name:"ãƒ©ãƒƒã‚­ãƒ¼ãƒ‡ãƒ¼ï¼", time:3600, prob:0.01}
];

// ã‚¹ã‚¿ãƒ¼ãƒˆãƒœã‚¿ãƒ³
startBtn.addEventListener("click", () => {
  if (locked) return;
  count++;
  countDisplay.textContent = "å›æ•°: " + count;
  startGacha();
});

// ã‚¬ãƒãƒ£æŠ½é¸
function startGacha() {
  let r = Math.random();
  let sum = 0;
  let result;

  for (let g of ranks) {
    sum += g.prob;
    if (r < sum) {
      result = g;
      break;
    }
  }

  rankText.textContent = result.name;
  effectText.textContent = `ãƒ­ãƒƒã‚¯ ${result.time/60} åˆ†`;

  // ç”»é¢åˆ‡æ›¿
  startScreen.style.display = "none";
  resultScreen.style.display = "flex";

  locked = true;
  startBtn.disabled = true;

  startTimer(result.time);
}

// ã‚¿ã‚¤ãƒãƒ¼
function startTimer(sec) {
  clearInterval(timerInterval);
  let t = sec;

  timerInterval = setInterval(() => {
    let m = Math.floor(t / 60);
    let s = t % 60;
    timerDisplay.textContent = `æ®‹ã‚Š ${m}:${s.toString().padStart(2,"0")}`;
    t--;

    if (t < 0) {
      clearInterval(timerInterval);
      locked = false;
      startBtn.disabled = false;
      timerDisplay.textContent = "è§£æ”¾ï¼";
    }
  }, 1000);
}

// çµæœç”»é¢é–‰ã˜ã‚‹
closeBtn.onclick = () => {
  resultScreen.style.display = "none";
  startScreen.style.display = "block";
};
</script>

</body>
</html>
